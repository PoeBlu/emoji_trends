<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/roughjs@3.1.0/dist/rough.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-rough@0.2.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-deferred@1"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.7.0/d3.min.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Fredoka+One&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Luckiest+Guy&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="./style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

</head>



<body>
    <h1>EMOJI TRENDS</h1>

    <div class="container">
        <div class="row">
            <div class="col-12 mt-4">
                <div class="card category">
                    Soccer Ball‚öΩ
                    <div class="card-body" id="box">
                        <canvas id="football" style="min-height:350px"></canvas>

                    </div>
                </div>
                <div class="card category">
                    Bee üêù
                    <div class="card-body" id="box">
                        <canvas id="bee" style="min-height:350px"></canvas>

                    </div>
                </div>
                <div class="card category">
                    <div class="card-body" id="box">
                        <canvas id="bee2" style="min-height:350px"></canvas>

                    </div>
                </div>
                <div class="card">
                    <div class="card-body" id="box">
                        <canvas id="bee3" style="min-height:350px"></canvas>

                    </div>
                </div>
                <div class="card">
                    <div class="card-body" id="box">
                        <canvas id="bee4" style="min-height:350px"></canvas>

                    </div>
                </div>
                <div class="card">
                    <div class="card-body" id="box">
                        <canvas id="bee5" style="min-height:350px"></canvas>

                    </div>
                </div>
            </div>
        </div>
    </div>


    <script>
        var annotations = {};
        annotations["football"] = ["2014-06-12", "Brazil World Cup 2014 started"];
        function makeChart(dates, emoji_name, emoji, color1) {
            var day = dates.map(function (d) {
                return d.day;
            });
            var usage = dates.map(function (d) {
                return d.usage;
            });

            Chart.defaults.global.legend = false;
            Chart.defaults.global.animation.duration = 700;
            Chart.defaults.global.tooltips.intersect = false;
            Chart.defaults.global.tooltips.borderWidth = 3;
            Chart.defaults.global.tooltips.borderColor = 'black';
            Chart.defaults.global.tooltips.yAlign = 'bottom';
            Chart.defaults.global.tooltips.backgroundColor = 'white';
            Chart.defaults.global.tooltips.titleFontSize = 16;
            Chart.defaults.global.tooltips.titleFontColor = 'black';
            Chart.defaults.global.tooltips.bodyFontColor = '#000';
            Chart.defaults.global.tooltips.bodyFontSize = 14;
            Chart.defaults.global.tooltips.displayColors = false;
            Chart.defaults.global.defaultFontFamily = '"Fredoka One", cursive';
            Chart.defaults.global.maintainAspectRatio = false;
            Chart.defaults.global.responsive = true;

            scale_options = {

                yAxes: [{ display: false }],
                xAxes: [{
                    type: 'time',
                    time: {
                        unit: 'year'
                    },
                    ticks: {
                        fontColor: 'black',
                        fontSize: 18,
                    },
                    gridLines: {
                        display: false
                    },
                }],

            };

            var football = document.getElementById(emoji_name);
            new Chart(football.getContext("2d"), {
                plugins: [
                    ChartRough,
                    { deferred: { yOffset: 1, delay: 3200, } }
                ],
                type: ['line'],
                options: {
                    layout: {
                        padding: {
                            left: 0,
                            right: 0,
                            top: 65,
                            bottom: 0
                        }
                    },
                    scales: scale_options,
                    tooltips: {
                        caretPadding: 10,
                        caretSize: 7,
                        cornerRadius: 15,
                        titleFontSize: 18,
                        titleFontStyle: 'normal',
                        titleFontColor: 'black',
                        titleSpacing: 8,
                        bodyFontStyle: 'bold',
                        bodyFontSize: 20,
                        bodySpacing: 6,
                        callbacks: {
                            title: function (tooltipItem) {
                                var multistringText = [tooltipItem[0].xLabel];
                                multistringText.push(Number(tooltipItem[0].yLabel).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + " people tweeted a " + emoji);
                                return multistringText;
                            },
                            label: function (tooltipItem) {
                                console.log(tooltipItem.xLabel);
                                console.log(emoji_name);
                                if (emoji_name in annotations) {
                                    if (annotations[emoji_name][0] == tooltipItem.xLabel) {
                                        return annotations[emoji_name][1];
                                    }
                                } else {
                                    return ""
                                }

                            },
                        }
                    }
                },
                data: {
                    labels: day,
                    datasets: [{
                        backgroundColor: color1,
                        data: usage,
                        pointRadius: 0,
                        pointHoverRadius: 6,
                        hoverBackgroundColor: 'black',
                        pointHoverBorderColor: 'black',
                        pointHitRadius: 30,
                        pointHoverBorderWidth: 3,
                        pointBackgroundColor: color1,
                        pointBorderColor: color1,
                        borderColor: 'black',
                        rough: {
                            roughness: 1.5,
                            bowing: 0,
                            fillStyle: 'hachure',
                            fillWeight: 4,
                            hachureAngle: -41,
                            hachureGap: 6,
                            // curveStepCount: 70,
                            simplification: 0
                        }
                    }]
                }
            });
        }

        Promise.all([
            d3.csv("output/football2.csv"),
            d3.csv("output/bee2.csv"),
        ]).then(function (files) {
            makeChart(files[0], 'football', '‚öΩ', '#00188f');
            makeChart(files[1], 'bee', 'üêù', '#fff100');
            makeChart(files[1], 'bee2', 'üçâ', '#009e49');
            makeChart(files[1], 'bee3', 'ü¶ä', '#00bcf2');
            makeChart(files[1], 'bee4', 'üêù', '#e81123');
            makeChart(files[1], 'bee5', 'üêù', '#68217a');
        })


    </script>

</body>

</html>