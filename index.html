<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-deferred@1"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.7.0/d3.min.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Fredoka+One&display=swap" rel="stylesheet">
</head>

<body>

    <div>

        <div>
            <canvas id="football" width="80%" height="30%"></canvas>
        </div>
        <div>
            <canvas id="bee" width="80%" height="30%"></canvas>
        </div>

    </div>

    <script>
        var mydata;
        function makeChart(dates, emoji_name, emoji, color1) {
            var myconfig = [{ deferred: { xOffset: '50%', delay: 1250, } }];
            var day = dates.map(function (d) {
                return d.day;
            });
            var usage = dates.map(function (d) {
                return d.usage;
            });



            Chart.defaults.global.plugins = [{ deferred: { yOffset: 500, delay: 1200, } }];
            Chart.defaults.global.responsive = true;
            Chart.defaults.global.legend = false;
            Chart.defaults.global.animation.duration = 4000;
            Chart.defaults.global.tooltips.intersect = false;
            Chart.defaults.global.tooltips.borderWidth = 3;
            Chart.defaults.global.tooltips.borderColor = 'black';
            Chart.defaults.global.tooltips.yAlign = 'bottom';
            Chart.defaults.global.tooltips.backgroundColor = 'white';
            Chart.defaults.global.tooltips.titleFontSize = 16;
            Chart.defaults.global.tooltips.titleFontColor = 'black';
            Chart.defaults.global.tooltips.bodyFontColor = '#000';
            Chart.defaults.global.tooltips.bodyFontSize = 14;
            Chart.defaults.global.tooltips.displayColors = false;
            Chart.defaults.global.defaultFontFamily = 'Fredoka One';


            scale_options = {

                yAxes: [{ display: false }],
                xAxes: [{
                    type: 'time',
                    time: {
                        unit: 'year'
                    },
                    ticks: {
                        fontColor: 'black',
                        fontSize: 18,
                    },
                    gridLines: {
                        display: false
                    },
                }],

            };

            var football = document.getElementById(emoji_name);
            new Chart(football.getContext("2d"), {
                type: ['line'],
                options: {
                    scales: scale_options,
                    tooltips: {
                        titleFontSize: 14,
                        titleFontStyle: 'normal',
                        callbacks: {
                            title: function (tooltipItem) {
                                return "On  " + tooltipItem[0].xLabel;
                            },
                            label: function (tooltipItem) {
                                return Number(tooltipItem.yLabel).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + " people tweeted a " + emoji;
                            }
                        }
                    }
                },
                data: {
                    labels: day,
                    datasets: [{
                        backgroundColor: color1,
                        data: usage,
                        pointRadius: 0,
                        borderWidth: 4,
                        borderColor: 'black',
                    }]
                }
            });
        }

        Promise.all([
            d3.csv("output/football_sampled.csv"),
            d3.csv("output/bee_sampled.csv"),
        ]).then(function (files) {
            makeChart(files[0], 'football', '‚öΩ', '#bc444c');
            makeChart(files[1], 'bee', 'üêù', '#fbf492');
        })


    </script>

</body>

</html>